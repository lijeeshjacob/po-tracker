<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body { font-family: Arial; padding: 20px; }
      table { border-collapse: collapse; width: 100%; margin-top: 20px; }
      th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
      th { background: #f2f2f2; }
      input, button { padding: 6px; margin: 4px 0; }
      input[type="date"] { width: 160px; }
    </style>
  </head>
  <body>
    <h2>PO Tracker</h2>
    <form id="poForm">
      <input type="text" id="PO Number" placeholder="PO Number" required>
      <input type="text" id="Supplier" placeholder="Supplier" required>
      <input type="date" id="Delivery Date" required>
      <input type="text" id="Status" placeholder="Status">
      <br>
      <button type="submit">Add PO</button>
    </form>

    <table id="poTable">
      <thead>
        <tr>
          <th>PO Number</th>
          <th>Supplier</th>
          <th>Delivery Date</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <script>
      // On form submit: save PO, then reload table
      document.getElementById('poForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const po = {
          "PO Number": document.getElementById("PO Number").value,
          "Supplier": document.getElementById("Supplier").value,
          "Delivery Date": document.getElementById("Delivery Date").value,
          "Status": document.getElementById("Status").value
        };
        google.script.run.withSuccessHandler(loadPOs).savePO(po);
        this.reset();
      });

      // Populate table with PO data
      function loadPOs(poList) {
        const tbody = document.querySelector("#poTable tbody");
        tbody.innerHTML = "";
        poList.forEach(po => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${po["PO Number"] || ""}</td>
            <td>${po["Supplier"] || ""}</td>
            <td>${po["Delivery Date"] || ""}</td>
            <td>${po["Status"] || ""}</td>
          `;
          tbody.appendChild(tr);
        });
      }

      // Load POs when page loads
      window.onload = () => {
        google.script.run.withSuccessHandler(loadPOs).loadPOs();
      };
    </script>
  </body>
</html>
